%
% Putting the talks (program) in tabu tables
%
% Tias Guns
%
\NeedsTeXFormat{LaTeX2e}
\ProvidesPackage{talktables}[2014/12/08]
\usepackage{tabu}
\usepackage{multirow}
\usepackage[table]{xcolor}
\usepackage{truncate}

\newenvironment{talktable}[1]{%
    \begin{tabu} to \linewidth {c *{#1}{X} }
}{
    \end{tabu}
}%
\newcommand{\HeaderTitle}[1]{%
    \multicolumn{1}{c}{\bf \large #1}%
}%
\newcommand{\HeaderSubtitle}[1]{%
    \multicolumn{1}{c}{\large #1}%
}%
\newcommand{\TalkTitle}[1]{%
    {\large #1}%
}%
\newcommand{\TalkSpeaker}[1]{%
    {#1}%
}%
\newcommand{\CellTalk}[3]{%
	%
    % #1: nr rows
	% #2: Title
	% #3: Authors
	%
    \multirow{#1}{\linewidth}{%
     \begin{minipage}{\linewidth}
     \TalkTitle{#2}\\%
     $ $\\
     \TalkSpeaker{-- #3}%
     \end{minipage}%
    }%
}%
\newcommand{\CellTalkCompact}[3]{%
    \multirow{#1}{\linewidth}{%
     \begin{minipage}{\linewidth}
     \TalkTitle{#2}\\
     \TalkSpeaker{-- #3}%
     \end{minipage}%
    }%
}%
\newcommand{\CellTalkTrunk}[3]{%
    \multirow{#1}{\linewidth}{%
     \begin{minipage}{\linewidth}
     \TalkTitle{#2}\\
     \TalkSpeaker{\truncate{\linewidth}{-- #3}}%
     \end{minipage}%
    }%
}%
\newcommand{\CellTalkTrunkTrunk}[3]{%
    \multirow{#1}{\linewidth}{%
     \begin{minipage}{\linewidth}
     \TalkTitle{\truncate{\linewidth}{#2}}\\
     \TalkSpeaker{\truncate{\linewidth}{-- #3}}%
     \end{minipage}%
    }%
}%
\newcommand{\CellTalkSingle}[3]{%
    \multirow{#1}{\linewidth}{%
     \TalkTitle{\truncate{\linewidth}{#2}}%
    }%
}%
%
% From: http://tex.stackexchange.com/questions/41758/how-can-i-reproduce-this-table-with-thick-lines
\newcommand{\thickcline}[1]{%
    \@thickcline #1\@nil%
}
\def\@thickcline#1-#2\@nil{%
  \omit
  \@multicnt#1%
  \advance\@multispan\m@ne
  \ifnum\@multicnt=\@ne\@firstofone{&\omit}\fi
  \@multicnt#2%
  \advance\@multicnt-#1%
  \advance\@multispan\@ne
  \leaders\hrule\@height1pt\hfill
  \cr
  \noalign{\vskip-1pt}%
}
